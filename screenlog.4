[?25l[61;86H5,11[40;15H[34h[?25h[?25l[61;86H4,58[39;62H[34h[?25h[?25l[61;86H3,21[38;25H[34h[?25h[?25l[61;86H2,0-1[37;5H[34h[?25h[?25l[61;86H1,23 [36;27H[34h[?25h[?25l[61;86H0,41[35;45H[34h[?25h[?25l[61;85H59,30[34;34H[34h[?25h[?25l[61;86H8,21[33;25H[34h[?25h[?25l[61;86H7,24[32;28H[34h[?25h[?25l[61;86H6,40[31;44H[34h[?25h[?25l[61;86H5,11[30;15H[34h[?25h[?25l[61;86H4,34[29;38H[34h[?25h[?25l[61;86H3,20[28;24H[34h[?25h[?25l[61;86H2,0-1[27;5H[34h[?25h[?25l[61;86H1,25 [26;29H[34h[?25h[?25l[61;86H0,22[25;26H[34h[?25h[?25l[61;85H49,4[24;46H[34h[?25h[?25l[61;86H8,38[23;42H[34h[?25h[?25l[61;86H7,47[22;51H[34h[?25h[?25l[61;86H6,24[21;28H[34h[?25h[?25l[61;86H5,43[20;47H[34h[?25h[?25l[61;86H4,11[19;15H[34h[?25h[?25l[61;86H3[18;15H[34h[?25h[?25l[61;86H2,20[17;24H[34h[?25h[?25l[61;86H1,0-1[16;5H[34h[?25h[?25l[15;35H[46m([11C)[0m[61;86H0,43 [15;47H[34h[?25h[?25l[15;35H([11C)[61;85H39,29[14;33H[34h[?25h[?25l[61;86H8,36[13;40H[34h[?25h[?25l[61;86H7,58[12;62H[34h[?25h[?25l[61;86H6,11[11;15H[34h[?25h[?25l[61;86H5,45[10;49H[34h[?25h[?25l[61;86H4,31[9;35H[34h[?25h[?25l[8;48H[95m[46m([4C)[0m[61;86H3,49[8;53H[34h[?25h[?25l[95m(2009)[0m[61;86H2,58[7;62H[34h[?25h[?25l[61;86H1,30[6;34H[34h[?25h[?25l[61;86H0,58[5;62H[34h[?25h[?25l[61;85H29,2[4;32H[34h[?25h[?25l[61;86H8,1[3;22H[34h[?25h[?25l[61;86H7[2;22H[34h[?25h[?25l[61;86H6,8 [1;12H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m 25 [0m[8C[95m''' catalog of subhalos over the snapshots 1 to nsnap0 [0m[61;85H[K[61;85H25,58[10C3%[1;62H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m 24 [0m    [93mdef[0m [1m[96m__init__[0m(self, sigma_smhm=[95m0.2[0m, smf_source=[95m'li-march'[0m, nsnap0=[95m20[0m):[61;85H[K[61;85H24,58[10C3%[1;62H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m 23 class[0m [1m[96mSubhalos[0m([1m[96mobject[0m):[61;85H[K[61;85H23,24[10C3%[1;28H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m 22 [0m[61;85H[K[61;85H22,0-1[9C3%[1;5H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m 21 [0m    [93mpass[0m[60;1H[94m@                                                                                                     [0m[61;85H[K[61;85H21,8[11C3%[1;12H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m 20 except[0m [38;5;121mImportError[0m:[61;85H[K[61;85H20,19[10C2%[1;23H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m 19 [0m    [38;5;81mfrom[0m utilities [38;5;81mimport[0m utility [93mas[0m wetzel_util[61;85H[K[61;85H19,48[10C2%[1;52H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m 18 [0m    [38;5;81mfrom[0m treepm [38;5;81mimport[0m subhalo_io[61;85H[K[61;85H18,34[10C2%[1;38H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m 17 try[0m:[61;85H[K[61;85H17,5[11C2%[1;9H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m 16 [0m[38;5;81mimport[0m sham_hack [93mas[0m sham[61;85H[K[61;85H16,24[10C2%[1;28H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m 15 [0m[38;5;130m# modules only available on Harmattan or Sirocco[0m[61;85H[K[61;85H15,48[10C2%[1;52H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m 14 [0m[61;85H[K[61;85H14,0-1[9C2%[1;5H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m 13 [0m[38;5;81mfrom[0m ChangTools.fitstables [38;5;81mimport[0m mrdfits[61;85H[K[61;85H13,41[10C1%[1;45H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m 12 [0m[38;5;81mimport[0m util [93mas[0m UT[61;85H[K[61;85H12,17[10C1%[1;21H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m 11 [0m[38;5;130m# --- Local --- [0m[61;85H[K[61;85H11,16[10C1%[1;20H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m 10 [0m[61;85H[K[61;85H10,0-1[9C1%[1;5H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m  9 [0m[38;5;81mimport[0m numpy [93mas[0m np[61;85H[K[61;85H9,18[11C1%[1;22H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m  8 [0m[38;5;81mimport[0m h5py[61;85H[K[61;85H8,11[11C1%[1;15H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m  7 [0m[38;5;81mimport[0m os[61;85H[K[61;85H7,9[12C0%[1;13H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m  6 [0m[95m'''[0m[61;85H[K[61;85H6,3[12C0%[1;7H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m  5 [0m[61;85H[K[61;85H5,0-1[10C0%[1;5H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m  4 [0m[61;85H[K[61;85H4,0-1[10C0%[1;5H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m  3 [0m[95mCreate catalog for centralMS project. [0m[61;85H[K[61;85H3,38[11C0%[1;42H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m  2 [0m[61;85H[K[61;85H2,0-1[10C0%[1;5H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m  1 [0m[95m'''[0m[61;85H[K[61;85H1,3[11CTop[1;7H[34h[?25h[?25l[61;85H2,0-1[2;5H[34h[?25h[?25l[61;85H3,38 [3;42H[34h[?25h[?25l[61;85H4,0-1[4;5H[34h[?25h[?25l[61;85H5[5;5H[34h[?25h[?25l[61;85H6,3  [6;7H[34h[?25h[?25l[61;85H7,9[7;13H[34h[?25h[?25l[61;85H8,11[8;15H[34h[?25h[?25l[61;85H9,18[9;22H[34h[?25h[?25l[61;85H10,0-1[10;5H[34h[?25h[?25l[61;86H1,16 [11;20H[34h[?25h[?25l[61;86H2,17[12;21H[34h[?25h[?25l[61;86H3,41[13;45H[34h[?25h[?25l[61;86H4,0-1[14;5H[34h[?25h[?25l[61;86H5,48 [15;52H[34h[?25h[?25l[61;86H6,24[16;28H[34h[?25h[?25l[61;86H7,5 [17;9H[34h[?25h[?25l[61;86H8,34[18;38H[34h[?25h[?25l[61;86H9,48[19;52H[34h[?25h[?25l[61;85H20,19[20;23H[34h[?25h[?25l[61;86H1,8 [21;12H[34h[?25h[?25l[61;86H2,0-1[22;5H[34h[?25h[?25l[61;86H3,24 [23;28H[34h[?25h[?25l[61;86H4,58[24;62H[34h[?25h[?25l[61;86H5[25;62H[34h[?25h[?25l[61;86H6,8 [26;12H[34h[?25h[?25l[61;86H7,18[27;22H[34h[?25h[?25l[61;86H8[28;22H[34h[?25h[?25l[61;86H9,2[29;32H[34h[?25h[?25l[61;85H30,5[30;62H[34h[?25h[?25l[61;86H1,30[31;34H[34h[?25h[?25l[61;86H2,58[32;62H[34h[?25h[?25l[33;48H[95m[46m([4C)[0m[61;86H3,49[33;53H[34h[?25h[?25l[95m(2009)[0m[61;86H4,31[34;35H[34h[?25h[?25l[61;86H5,45[35;49H[34h[?25h[?25l[61;86H6,11[36;15H[34h[?25h[?25l[61;86H7,58[37;62H[34h[?25h[?25l[61;86H8,36[38;40H[34h[?25h[?25l[61;86H9,29[39;33H[34h[?25h[?25l[40;35H[46m([11C)[0m[61;85H40,43[40;47H[34h[?25h[?25l[40;35H([11C)[61;86H1,0-1[41;5H[34h[?25h[?25l[61;86H2,20 [42;24H[34h[?25h[?25l[61;86H3,11[43;15H[34h[?25h[?25l[61;86H4[44;15H[34h[?25h[?25l[61;86H5,43[45;47H[34h[?25h[?25l[61;86H6,24[46;28H[34h[?25h[?25l[61;86H7,47[47;51H[34h[?25h[?25l[61;86H8,38[48;42H[34h[?25h[?25l[61;86H9,42[49;46H[34h[?25h[?25l[61;85H50,2[50;26H[34h[?25h[?25l[61;86H1,25[51;29H[34h[?25h[?25l[61;86H2,0-1[52;5H[34h[?25h[?25l[61;86H3,20 [53;24H[34h[?25h[?25l[61;86H4,34[54;38H[34h[?25h[?25l[61;86H5,11[55;15H[34h[?25h[?25l[61;86H6,40[56;44H[34h[?25h[?25l[61;86H7,24[57;28H[34h[?25h[?25l[61;86H8,21[58;25H[34h[?25h[?25l[61;86H9,30[59;34H[34h[?25h[?25l[61;85H60,41[60;45H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 61 [8Creturn[0m catalog[61;85H[K[61;85H61,23[10C0%[60;27H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 62 [0m[61;85H[K[61;85H62,0-1[9C0%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 63 [0m    [93mdef[0m [1m[96mBuild[0m(self):[61;85H[K[61;85H63,21[10C0%[60;25H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 64 [0m[8C[95m'''Construct the subhalo/SHAM M* history into hdf5 format[0m[61;85H[K[61;85H64,58[10C0%[60;62H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 65 [0m[95m        '''[0m[61;85H[K[61;85H65,11[10C0%[60;15H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 66 [0m[8C[38;5;130m# import that subhalos from snapshots [0m[61;85H[K[61;85H66,46[10C0%[60;50H[34h[?25h[?25l[61;86H5,11[59;15H[34h[?25h[?25l[61;86H4,58[58;62H[34h[?25h[?25l[61;86H3,21[57;25H[34h[?25h[?25l[61;86H2,0-1[56;5H[34h[?25h[?25l[61;86H1,23 [55;27H[34h[?25h[?25l[61;86H0,41[54;45H[34h[?25h[?25l[61;85H59,30[53;34H[34h[?25h[?25l[61;86H8,21[52;25H[34h[?25h[?25l[61;86H7,24[51;28H[34h[?25h[?25l[61;86H6,40[50;44H[34h[?25h[?25l[61;86H5,11[49;15H[34h[?25h[?25l[61;86H4,34[48;38H[34h[?25h[?25l[61;86H3,20[47;24H[34h[?25h[?25l[61;86H2,0-1[46;5H[34h[?25h[?25l[61;86H1,25 [45;29H[34h[?25h[?25l[61;86H0,22[44;26H[34h[?25h[?25l[61;85H49,4[43;46H[34h[?25h[?25l[61;86H8,38[42;42H[34h[?25h[?25l[61;86H7,47[41;51H[34h[?25h[?25l[61;86H6,24[40;28H[34h[?25h[?25l[61;86H5,43[39;47H[34h[?25h[?25l[61;86H4,11[38;15H[34h[?25h[?25l[61;86H3[37;15H[34h[?25h[?25l[61;86H2,20[36;24H[34h[?25h[?25l[61;86H1,0-1[35;5H[34h[?25h[?25l[34;35H[46m([11C)[0m[61;86H0,43 [34;47H[34h[?25h[?25l[34;35H([11C)[61;85H39,29[33;33H[34h[?25h[?25l[61;86H8,36[32;40H[34h[?25h[?25l[61;86H7,58[31;62H[34h[?25h[?25l[61;86H6,11[30;15H[34h[?25h[?25l[61;86H5,45[29;49H[34h[?25h[?25l[61;86H4,31[28;35H[34h[?25h[?25l[27;48H[95m[46m([4C)[0m[61;86H3,49[27;53H[34h[?25h[?25l[95m(2009)[0m[61;86H2,58[26;62H[34h[?25h[?25l[61;86H1,30[25;34H[34h[?25h[?25l[61;86H0,58[24;62H[34h[?25h[?25l[61;85H29,2[23;32H[34h[?25h[?25l[61;86H8,1[22;22H[34h[?25h[?25l[61;86H7[21;22H[34h[?25h[?25l[61;86H6,8 [20;12H[34h[?25h[?25l[61;86H5,58[19;62H[34h[?25h[?25l[61;86H4[18;62H[34h[?25h[?25l[61;86H3,24[17;28H[34h[?25h[?25l[61;86H2,0-1[16;5H[34h[?25h[?25l[61;86H1,8  [15;12H[34h[?25h[?25l[61;86H0,19[14;23H[34h[?25h[?25l[61;85H19,48[13;52H[34h[?25h[?25l[61;86H8,34[12;38H[34h[?25h[?25l[61;86H7,5 [11;9H[34h[?25h[?25l[61;86H6,24[10;28H[34h[?25h[?25l[61;86H5,48[9;52H[34h[?25h[?25l[61;86H4,0-1[8;5H[34h[?25h[?25l[61;86H3,41 [7;45H[34h[?25h[?25l[61;86H2,17[6;21H[34h[?25h[?25l[61;86H1,16[5;20H[34h[?25h[?25l[61;86H0,0-1[4;5H[34h[?25h[?25l[61;85H9,18  [3;22H[34h[?25h[?25l[61;85H8,11[2;15H[34h[?25h[?25l[61;85H7,9 [1;13H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m  6 [0m[95m'''[0m[61;85H[K[61;85H6,3[12C0%[1;7H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m  5 [0m[61;85H[K[61;85H5,0-1[10C0%[1;5H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m  4 [0m[61;85H[K[61;85H4,0-1[10C0%[1;5H[34h[?25h[?25l[1;60r[1;1H[L[1;61r[1;1H[93m  3 [0m[95mCreate catalog for centralMS project. [0m[61;85H[K[61;85H3,38[11C0%[1;42H[34h[?25h[?25l[61;85H[K[61;1H:[34h[?25hq[?25l[34h[?25h[?25l[61;1H[K[61;1H[?1l>[34h[?25h[?1049lkstaudt@harmattan:/home/users/hahn/projects/centralMS/centralms\[staudt@harmattan centralms]$ ls
[0m[01;32mabcee.py[0m     [01;32mcentralms.pyc[0m  __init__.pyc  [01;32mobservables.py[0m   [01;34m__pycache__[0m  [01;32msfrs.pyc[0m       Untitled.ipynb
[01;32mabcee.pyc[0m    [01;32mevolver.py[0m     [01;32mlabram.py[0m     [01;32mobservables.pyc[0m  [34;42mrun[0m          [01;32msham_hack.py[0m   [01;32mutil.py[0m
[01;32mcatalog.py[0m   [01;32mevolver.pyc[0m    [01;32mmodels.pyc[0m    [01;32mpaper.py[0m         [01;32msfh.py[0m       [01;32msham_hack.pyc[0m  [01;32mutil.pyc[0m
[01;32mcatalog.pyc[0m  [01;32m__init__.py[0m    [34;42mnotebooks[0m     [01;32mplots.py[0m         [01;32msfh.pyc[0m      [34;42mtests[0m
kstaudt@harmattan:/home/users/hahn/projects/centralMS/centralms\[staudt@harmattan centralms]$ vim catalog.py
[?1049h[?1h=[1;61r[34l[34h[?25h[23m[24m[0m[H[J[?25l[61;1H"catalog.py" 710L, 29823C[1;1H[93m  1 [0m[95m'''[0m
[93m  2 
  3 [0m[95mCreate catalog for centralMS project. [0m
[93m  4 
  5 
  6 [0m[95m'''[0m
[93m  7 [0m[38;5;81mimport[0m os
[93m  8 [0m[38;5;81mimport[0m h5py
[93m  9 [0m[38;5;81mimport[0m numpy [93mas[0m np
[93m 10 
 11 [0m[38;5;130m# --- Local --- [0m
[93m 12 [0m[38;5;81mimport[0m util [93mas[0m UT
[93m 13 [0m[38;5;81mfrom[0m ChangTools.fitstables [38;5;81mimport[0m mrdfits
[93m 14 
 15 [0m[38;5;130m# modules only available on Harmattan or Sirocco[0m
[93m 16 [0m[38;5;81mimport[0m sham_hack [93mas[0m sham
[93m 17 try[0m:
[93m 18 [0m    [38;5;81mfrom[0m treepm [38;5;81mimport[0m subhalo_io
[93m 19 [0m    [38;5;81mfrom[0m utilities [38;5;81mimport[0m utility [93mas[0m wetzel_util
[93m 20 except[0m [38;5;121mImportError[0m:
[93m 21 [0m    [93mpass
 22 
 23 class[0m [1m[96mSubhalos[0m([1m[96mobject[0m):
[93m 24 [0m    [93mdef[0m [1m[96m__init__[0m(self, sigma_smhm=[95m0.2[0m, smf_source=[95m'li-march'[0m, nsnap0=[95m20[0m):
[93m 25 [0m[8C[95m''' catalog of subhalos over the snapshots 1 to nsnap0 [0m
[93m 26 [0m[95m        [0m
[93m 27 [0m[95m        Parameters[0m
[93m 28 [0m[95m        ----------[0m
[93m 29 [0m[95m        * sigma_smhm : float[0m
[93m 30 [0m[95m            Scatter in the Stellar Mass to Halo Mass relation. Default is 0.2[0m
[93m 31 [0m[95m        * smf_source : string [0m
[93m 32 [0m[95m            SMF choice for SHAM. Default is Li et al.(2009) at z~0 interpolated at[0m
[93m 33 [0m[95m            higher z with Marchesini et al.(2009)[0m
[93m 34 [0m[95m        * nsnap_ancestor : int [0m
[93m 35 [0m[95m            Snapshot limit to track back to. [0m
[93m 36 [0m[95m        '''[0m
[93m 37 [0m[8Cself.sigma_smhm = sigma_smhm [38;5;130m# stellar mass to halo mass relation [0m
[93m 38 [0m[8Cself.smf_source = smf_source
[93m 39 [0m[8Cself.nsnap0 = nsnap0
[93m 40 [0m[8Cself.snapshots = [1m[96mrange[0m([95m1[0m, nsnap0+[95m1[0m)
[93m 41 
 42 [0m    [93mdef[0m [1m[96mFile[0m(self):
[93m 43 [0m[8C[95m'''[0m
[93m 44 [0m[95m        '''[0m
[93m 45 [0m[8Cfile_name = [95m''[0m.join([UT.dat_dir(),
[93m 46 [0m[12C[95m'Subhalos'[0m,
[93m 47 [0m[12C[95m'.SHAMscat'[0m, [1m[96mstr[0m(self.sigma_smhm),
[93m 48 [0m[12C[95m'.smf_'[0m, self.smf_source,
[93m 49 [0m[12C[95m'.nsnap0_'[0m, [1m[96mstr[0m(self.nsnap0),
[93m 50 [0m[12C[95m'.hdf5'[0m])
[93m 51 [8Creturn[0m file_name
[93m 52 
 53 [0m    [93mdef[0m [1m[96mRead[0m(self):
[93m 54 [0m[8C[95m''' Read in the hdf5 file [0m
[93m 55 [0m[95m        '''[0m
[93m 56 [0m[8Cf = h5py.File(self.File(), [95m'r'[0m)
[93m 57 [0m[8Cgrp = f[[95m'data'[0m]
[93m 58 [0m[8Ccatalog = {}
[93m 59 [8Cfor[0m key [93min[0m grp.keys():
[93m 60 [0m[12Ccatalog[key] = grp[key].value[61;85H3,1[11CTop[3;5H[34h[?25h[?25l[61;85H4,0-1[4;5H[34h[?25h[?25l[61;85H5[5;5H[34h[?25h[?25l[61;85H6,1  [6;5H[34h[?25h[?25l[61;85H7[7;5H[34h[?25h[?25l[61;85H8[8;5H[34h[?25h[?25l[61;85H9[9;5H[34h[?25h[?25l[61;85H10,0-1[10;5H[34h[?25h[?25l[61;86H1,1  [11;5H[34h[?25h[?25l[61;86H2[12;5H[34h[?25h[?25l[61;86H3[13;5H[34h[?25h[?25l[61;86H4,0-1[14;5H[34h[?25h[?25l[61;86H5,1  [15;5H[34h[?25h[?25l[61;86H6[16;5H[34h[?25h[?25l[61;86H7[17;5H[34h[?25h[?25l[61;86H8[18;5H[34h[?25h[?25l[61;86H9[19;5H[34h[?25h[?25l[61;85H20[20;5H[34h[?25h[?25l[61;86H1[21;5H[34h[?25h[?25l[61;86H2,0-1[22;5H[34h[?25h[?25l[61;86H3,1  [23;5H[34h[?25h[?25l[61;86H4[24;5H[34h[?25h[?25l[61;86H5[25;5H[34h[?25h[?25l[61;86H6[26;5H[34h[?25h[?25l[61;86H7[27;5H[34h[?25h[?25l[61;86H8[28;5H[34h[?25h[?25l[61;86H9[29;5H[34h[?25h[?25l[61;85H30[30;5H[34h[?25h[?25l[61;86H1[31;5H[34h[?25h[?25l[61;86H2[32;5H[34h[?25h[?25l[61;86H3[33;5H[34h[?25h[?25l[61;86H4[34;5H[34h[?25h[?25l[61;86H5[35;5H[34h[?25h[?25l[61;86H6[36;5H[34h[?25h[?25l[61;86H7[37;5H[34h[?25h[?25l[61;86H8[38;5H[34h[?25h[?25l[61;86H9[39;5H[34h[?25h[?25l[61;85H40[40;5H[34h[?25h[?25l[61;86H1,0-1[41;5H[34h[?25h[?25l[61;86H2,1  [42;5H[34h[?25h[?25l[61;86H3[43;5H[34h[?25h[?25l[61;86H4[44;5H[34h[?25h[?25l[61;86H5[45;5H[34h[?25h[?25l[61;86H6[46;5H[34h[?25h[?25l[61;86H7[47;5H[34h[?25h[?25l[61;86H8[48;5H[34h[?25h[?25l[61;86H9[49;5H[34h[?25h[?25l[61;85H50[50;5H[34h[?25h[?25l[61;86H1[51;5H[34h[?25h[?25l[61;86H2,0-1[52;5H[34h[?25h[?25l[61;86H3,1  [53;5H[34h[?25h[?25l[61;86H4[54;5H[34h[?25h[?25l[61;86H5[55;5H[34h[?25h[?25l[61;86H6[56;5H[34h[?25h[?25l[61;86H7[57;5H[34h[?25h[?25l[61;86H8[58;5H[34h[?25h[?25l[61;86H9[59;5H[34h[?25h[?25l[61;85H60[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 61 [8Creturn[0m catalog[61;1H[K[61;85H61,1[11C0%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 62 [0m[61;85H[K[61;85H62,0-1[9C0%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 63 [0m    [93mdef[0m [1m[96mBuild[0m(self):[61;85H[K[61;85H63,1[11C0%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 64 [0m[8C[95m'''Construct the subhalo/SHAM M* history into hdf5 format[0m[61;85H[K[61;85H64,1[11C0%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 65 [0m[95m        '''[0m[61;85H[K[61;85H65,1[11C0%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 66 [0m[8C[38;5;130m# import that subhalos from snapshots [0m[61;85H[K[61;85H66,1[11C0%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 67 [0m[8C[38;5;130m# note that snapshots earlier than nsnap0 are included [0m[61;85H[K[61;85H67,1[11C1%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 68 [0m[8C[38;5;130m# for assembly bias purposes[0m[61;85H[K[61;85H68,1[11C1%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 69 [0m[8C[30m[103msnaps_ext[0m = self.snapshots + [1m[96mrange[0m(self.nsnap0+[95m1[0m, self.nsnap0+[95m10[0m)[61;85H[K[61;85H69,1[11C1%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 70 [0m[8Csub = subhalo_io.Treepm.read([95m'subhalo'[0m, [95m250[0m, zis=[30m[103msnaps_ext[0m)[61;85H[K[61;85H70,1[11C1%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 71 [0m[61;85H[K[61;85H71,0-1[9C1%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 72 [0m[8C[38;5;130m# SHAM stellar masses to each of the subhalo catalogs[0m[61;85H[K[61;85H72,1[11C1%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 73 [0m[8Cm_kind = [95m'm.star'[0m[61;85H[K[61;85H73,1[11C2%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 74 [0m[8Csham.assign(sub, m_kind, scat=self.sigma_smhm,[61;85H[K[61;85H74,1[11C2%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 75 [0m[16Cdis_mf=[95m0.0[0m, source=self.smf_source, zis=self.snapshots)[61;85H[K[61;85H75,1[11C2%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 76 [0m[61;85H[K[61;85H76,0-1[9C2%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 77 [0m[8Ccatalog = {}[61;85H[K[61;85H77,1[11C2%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 78 [8Cfor[0m i_snap [93min[0m self.snapshots[[95m1[0m:]: [38;5;130m# 2 to nsnap0[0m[61;85H[K[61;85H78,1[11C2%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 79 [0m[12C[38;5;130m# find subhalos that correspond to snapshot 1 subhalos [0m[61;85H[K[61;85H79,1[11C2%[60;5H[34h[?25h[?25l[1;60r[1;1H[2M[1;61r[59;1H[93m 80 [0m[12Cindex_history = wetzel_util.utility_catalog.indices_tree(sub, [95m1[0m, i_snap, [1m[96mrange[0m([1m[96mlen[0m(subb[60;1H[93m    [0m[[95m1[0m][[95m'halo.m'[0m])))[61;85H[K[61;85H80,1[11C3%[59;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 81 [0m[12Cno_match = np.where(index_history < [95m0[0m)[[95m0[0m][61;85H[K[61;85H81,1[11C3%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 82 [0m[12Chasmatch = np.where(index_history > [95m0[0m)[[95m0[0m][61;85H[K[61;85H82,1[11C3%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 83 [0m[12Cindex_history[no_match] = -[95m999[0m  [38;5;130m# ones that do not have a match  [0m[61;85H[K[61;85H83,1[11C3%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 84 [0m[12Ccatalog[[95m'index.snap'[0m+[1m[96mstr[0m(i_snap)] = index_history[61;85H[K[61;85H84,1[11C3%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 85 [0m[12Cn_sub = [1m[96mlen[0m(index_history)[61;85H[K[61;85H85,1[11C3%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 86 [0m[61;85H[K[61;85H86,1[11C4%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 87 [12Cif[0m [1m[96mlen[0m(index_history) != [1m[96mlen[0m(sub[[95m1[0m][[95m'halo.m'[0m]):[61;85H[K[61;85H87,1[11C4%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 88 [16Craise[0m [38;5;121mValueError[0m[61;85H[K[61;85H88,1[11C4%[60;5H[34h[?25h[?25l[1;60r[1;1H[2M[1;61r[59;1H[93m 89 [0m[12C[1m[96mprint[0m np.[1m[96mfloat[0m([1m[96mlen[0m(hasmatch))/np.[1m[96mfloat[0m([1m[96mlen[0m(index_history)), [95m' of subhalos have matchess[0m[60;1H[93m    [0m[95m'[0m[61;85H[K[61;85H89,1[11C4%[59;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 90 [0m[61;85H[K[61;85H90,1[11C4%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 91 [0m[12C[38;5;130m# save specified subhalo properties from the snapshots[0m[61;85H[K[61;85H91,1[11C5%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 92 [12Cfor[0m prop [93min[0m [[95m'halo.m'[0m, [95m'm.max'[0m, [95m'm.star'[0m, [95m'ilk'[0m]:[61;85H[K[61;85H92,1[11C5%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 93 [16Cif[0m prop == [95m'ilk'[0m:[61;85H[K[61;85H93,1[11C5%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 94 [0m[20Ccatalog[prop+[95m'.snap'[0m+[1m[96mstr[0m(i_snap)] = np.repeat(-[95m999[0m, n_sub)[61;85H[K[61;85H94,1[11C5%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 95 [16Celse[0m:[61;85H[K[61;85H95,1[11C5%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 96 [0m[20Ccatalog[prop+[95m'.snap'[0m+[1m[96mstr[0m(i_snap)] = np.repeat(-[95m999.[0m, n_sub)[61;85H[K[61;85H96,1[11C5%[60;5H[34h[?25h[?25l[1;60r[1;1H[2M[1;61r[59;1H[93m 97 [0m[16Ccatalog[prop+[95m'.snap'[0m+[1m[96mstr[0m(i_snap)][hasmatch] = (sub[i_snap][prop])[index_history[haa[60;1H[93m    [0msmatch]][61;85H[K[61;85H97,1[11C6%[59;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 98 [0m[61;85H[K[61;85H98,0-1[9C6%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m 99 [0m[12C[38;5;130m# central indiex at snapshot i_snap[0m[61;85H[K[61;85H99,1[11C6%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m100 [0m[12Ccentral_indices = wetzel_util.utility_catalog.indices_ilk(sub[i_snap], ilk=[95m'cen'[0m)[61;85H[K[61;85H100,1[10C6%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m101 [0m[12Ccentral_snap = np.zeros([1m[96mlen[0m(sub[i_snap][[95m'halo.m'[0m]))[61;85H[K[61;85H101,1[10C6%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m102 [0m[12Ccentral_snap[central_indices] = [95m1[0m  [38;5;130m# 1 = central 0 = not central[0m[61;85H[K[61;85H102,1[10C6%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m103 [0m[61;85H[K[61;85H103,0-1[8C7%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m104 [0m[12Ccentral_history = np.repeat([95m0[0m, [1m[96mlen[0m(sub[[95m1[0m][[95m'halo.m'[0m]))[61;85H[K[61;85H104,1[10C7%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m105 [0m[12Ccentral_history[hasmatch] = central_snap[index_history[hasmatch]][61;85H[K[61;85H105,1[10C7%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m106 [0m[12Ccatalog[[95m'central.snap'[0m+[1m[96mstr[0m(i_snap)] = central_history[61;85H[K[61;85H106,1[10C7%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m107 [0m[61;85H[K[61;85H107,1[10C7%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m108 [0m[8C[38;5;130m# save halo.m and m.max in extra snapshots before nsnap_ancestor[0m[61;85H[K[61;85H108,1[10C7%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m109 [8Cfor[0m i_snap [93min[0m [1m[96mrange[0m(self.nsnap0+[95m1[0m, np.[1m[96mmax[0m([30m[103msnaps_ext[0m)+[95m1[0m):[61;85H[K[61;85H109,1[10C7%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m110 [0m[12C[38;5;130m# find subhalos that correspond to snapshot 1 subhalos [0m[61;85H[K[61;85H110,1[10C8%[60;5H[34h[?25h[?25l[1;60r[1;1H[2M[1;61r[59;1H[93m111 [0m[12Cindex_history = wetzel_util.utility_catalog.indices_tree(sub, [95m1[0m, i_snap, [1m[96mrange[0m([1m[96mlen[0m(subb[60;1H[93m    [0m[[95m1[0m][[95m'halo.m'[0m])))[61;85H[K[61;85H111,1[10C8%[59;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m112 [0m[12Cno_match = np.where(index_history < [95m0[0m)[[95m0[0m][61;85H[K[61;85H112,1[10C8%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m113 [0m[12Chasmatch = np.where(index_history > [95m0[0m)[[95m0[0m][61;85H[K[61;85H113,1[10C8%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m114 [0m[12Cindex_history[no_match] = -[95m999[0m  [38;5;130m# ones that do not have a match  [0m[61;85H[K[61;85H114,1[10C8%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m115 [0m[12Ccatalog[[95m'index.snap'[0m+[1m[96mstr[0m(i_snap)] = index_history[61;85H[K[61;85H115,1[10C9%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m116 [0m[61;85H[K[61;85H116,1[10C9%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m117 [12Cassert[0m [1m[96mlen[0m(index_history) == [1m[96mlen[0m(sub[[95m1[0m][[95m'halo.m'[0m])[61;85H[K[61;85H117,1[10C9%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m118 [0m[61;85H[K[61;85H118,0-1[8C9%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m119 [0m[12C[38;5;130m# save specified subhalo properties from the snapshots[0m[61;85H[K[61;85H119,1[10C9%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m120 [12Cfor[0m prop [93min[0m [[95m'halo.m'[0m, [95m'm.max'[0m]:[61;85H[K[61;85H120,1[10C9%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m121 [0m[16Ccatalog[prop+[95m'.snap'[0m+[1m[96mstr[0m(i_snap)] = np.repeat(-[95m999.[0m, n_sub)[61;85H[K[61;85H121,1[10C9%[60;5H[34h[?25h[?25l[1;60r[1;1H[2M[1;61r[59;1H[93m122 [0m[16Ccatalog[prop+[95m'.snap'[0m+[1m[96mstr[0m(i_snap)][hasmatch] = (sub[i_snap][prop])[index_history[haa[60;1H[93m    [0msmatch]][61;85H[K[61;85H122,1[9C10%[59;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m123 [0m[61;85H[K[61;85H123,0-1[7C10%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m124 [8Cfor[0m prop [93min[0m [[95m'halo.m'[0m, [95m'm.max'[0m, [95m'm.star'[0m, [95m'ilk'[0m]:[61;85H[K[61;85H124,1[9C10%[60;5H[34h[?25h[?25l[1;60r[60;1H
[1;61r[60;1H[93m125 [0m[12Ccatalog[prop] = sub[[95m1[0m][prop][61;85H[K[61;85H125,1[9C10%[60;5H[34h[?25h[?25l[11Ccatalog[prop] = sub[[95m1[0m][prop][60;44H[K[60;5H[34h[?25h[?25l
1 change; before #1  3 seconds ago[61;85H[K[60;16H catalog[prop] = sub[[95m1[0m][prop][61;85H125,1[9C10%[60;5H[34h[?25h[?25l
Already at oldest change[61;25H[K[61;85H125,1[9C10%[60;5H[34h[?25h[?25l[61;85H[K[61;85H125,1[9C10%[60;5H[34h[?25h[?25l[61;85H[K[61;85H125,1[9C10%[60;5H[34h[?25h[?25l[11Ccatalog[prop] = sub[[95m1[0m][prop][60;44H[K[60;5H[34h[?25h